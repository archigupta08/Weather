<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modern Weather App</title>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        margin: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background: linear-gradient(to bottom, #4facfe, #00f2fe);
        color: #fff;
        transition: background 1s ease;
      }

      .container {
        width: 380px;
        background: rgba(0, 0, 0, 0.4);
        padding: 20px;
        border-radius: 20px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        text-align: center;
        animation: fadeIn 1s ease;
        overflow-y: auto;
        max-height: 95vh;
      }

      h2 {
        margin-bottom: 15px;
      }

      input {
        padding: 10px;
        border-radius: 10px;
        border: none;
        width: 65%;
        outline: none;
      }

      button {
        padding: 10px 15px;
        border: none;
        border-radius: 10px;
        background: #ff9800;
        color: #fff;
        font-weight: bold;
        cursor: pointer;
        margin: 5px;
        transition: background 0.3s ease;
      }

      button:hover {
        background: #e67e00;
      }

      .weather {
        margin-top: 20px;
      }

      .temperature {
        font-size: 48px;
        font-weight: bold;
        margin: 10px 0;
      }

      .details {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin-top: 15px;
        font-size: 14px;
      }

      .details div {
        background: rgba(255, 255, 255, 0.2);
        padding: 10px;
        border-radius: 12px;
      }

      .forecast {
        margin-top: 20px;
      }

      .forecast-day {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(255, 255, 255, 0.2);
        padding: 10px;
        border-radius: 12px;
        margin: 5px 0;
      }

      .forecast-day img {
        width: 40px;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: scale(0.9);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h2>üå§ Weather App</h2>
      <input type="text" id="locationInput" placeholder="Enter city name..." />
      <button type="button" onclick="getWeather()">Search</button>
      <button type="button" onclick="getLocationWeather()">
        üìç My Location
      </button>
      <div id="weatherResult" class="weather"></div>
      <div id="forecastResult" class="forecast"></div>
    </div>

    <script>
      const apiKey = "3d2904d42d694154b8d111234251708";

      // Auto-detect on page load
      window.onload = () => getLocationWeather();

      async function getWeather() {
        const location = document.getElementById("locationInput").value.trim();
        if (!location) {
          document.getElementById("weatherResult").innerHTML =
            "<p style='color:yellow;'>‚ö†Ô∏è Enter a location</p>";
          return;
        }
        fetchWeather(location);
      }

      function getLocationWeather() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (pos) => {
              const lat = pos.coords.latitude;
              const lon = pos.coords.longitude;
              fetchWeather(`${lat},${lon}`);
            },
            () =>
              (document.getElementById("weatherResult").innerHTML =
                "<p style='color:red;'>‚ö†Ô∏è Location access denied</p>")
          );
        } else {
          document.getElementById("weatherResult").innerHTML =
            "<p style='color:red;'>‚ùå Geolocation not supported</p>";
        }
      }

      async function fetchWeather(query) {
        const url = `https://api.weatherapi.com/v1/forecast.json?key=${apiKey}&q=${query}&days=5&aqi=no&alerts=no`;

        try {
          const res = await fetch(url);
          if (!res.ok) throw new Error("‚ùå Location not found");
          const data = await res.json();

          const isDay = data.current.is_day === 1;
          document.body.style.background = isDay
            ? "linear-gradient(to bottom, #4facfe, #00f2fe)"
            : "linear-gradient(to bottom, #0f2027, #203a43, #2c5364)";

          // Current weather
          document.getElementById("weatherResult").innerHTML = `
          <h3>${data.location.name}, ${data.location.country}</h3>
          <img src="https:${data.current.condition.icon}" alt="icon">
          <p class="temperature">${data.current.temp_c}¬∞C</p>
          <p>Feels like: ${data.current.feelslike_c}¬∞C</p>
          <p>${data.current.condition.text}</p>
          <p>üïí Local Time: ${data.location.localtime}</p>
          <div class="details">
            <div>üíß Humidity: ${data.current.humidity}%</div>
            <div>üí® Wind: ${data.current.wind_kph} kph</div>
            <div>üå° Feels Like: ${data.current.feelslike_c}¬∞C</div>
            <div>‚òÅÔ∏è Cloud: ${data.current.cloud}%</div>
          </div>
        `;

          // Forecast (5 days)
          let forecastHTML = "<h3>üìÖ 5-Day Forecast</h3>";
          data.forecast.forecastday.forEach((day) => {
            forecastHTML += `
            <div class="forecast-day">
              <span>${day.date}</span>
              <img src="https:${day.day.condition.icon}" alt="icon">
              <span>${day.day.avgtemp_c}¬∞C</span>
              <span>${day.day.condition.text}</span>
            </div>
          `;
          });
          document.getElementById("forecastResult").innerHTML = forecastHTML;
        } catch (err) {
          document.getElementById(
            "weatherResult"
          ).innerHTML = `<p style="color:red;">${err.message}</p>`;
          document.getElementById("forecastResult").innerHTML = "";
        }
      }
    </script>
  </body>
</html>
